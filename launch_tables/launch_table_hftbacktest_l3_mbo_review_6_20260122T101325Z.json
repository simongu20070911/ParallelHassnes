{
  "working_root": "/Users/simongu/AAAHFT-Futures-Alpha-seek",
  "batch_goal_summary": "We need an ultra-deep, read-only audit of the Rust L3 MBO (market-by-order) simulation path in hftbacktest, focused on queue-position correctness and faithful fill logic when L3 MBO data is available. The goal is to detect any bugs, realism gaps, or design mismatches versus exchange reality (especially CME Globex) that could distort fills, queue position, or PnL. Each of 6 agents must examine a distinct slice of the Rust codebase in hftbacktest (no Python, docs, examples, connector, collector, or live) and produce a rigorous issue list with file:line evidence. Agents must classify issues as confirmed_bug, design_choice, or needs_spec; explain impact on realism; and propose minimal patch/test sketches. Use the CME DMA order-types spec in /Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md as a reality anchor for order semantics. No web search. No edits. No cargo. Shared workspace only. Output must be a Run Report JSON (schema_version=1.0.0) plus required PROMPT_* feedback lines. Emphasize matching-engine realism under MBO: ordering of add/modify/delete/fill events, same-timestamp tie-break rules, queue position resets, and how local orders are inserted into the L3 queue. Each agent should explicitly state any assumptions about CME matching (price-time vs pro-rata) and identify which behaviors are unsupported or approximated. The output should be actionable for a later bugfix pass and should include at least one concrete regression test idea per issue.",
  "concurrency": 6,
  "execution_policy": {
    "approval_policy": "never",
    "model_reasoning_effort": "xhigh",
    "sandbox": "read-only",
    "skip_git_repo_check": false,
    "web_search_enabled": false,
    "capture_events_jsonl": true,
    "capture_codex_thread_id": true
  },
  "retries": {
    "max_attempts": 1
  },
  "timeouts": {
    "step_timeout_seconds": 10800
  },
  "workspace_policy": {
    "mode": "shared"
  },
  "jobs": [
    {
      "job_id": "l3_review_01_queue_model_fifo",
      "working_directory": "hftbacktest",
      "steps": [
        {
          "step_id": "run",
          "timeout_seconds": 9000,
          "prompt": "AGENT_INJECTION_START\nYou are one of multiple parallel agents launched by an orchestrator (another GPT\u20115.2 instance).\nYou have a **narrow scope**. Do not expand it; do not \u201cimprove unrelated things\u201d.\n\n## Dual mandate (you must optimize both)\n\n1) **Mandate 2 (user goal):** execute your assigned slice to completion with high correctness.\n2) **Mandate 1 (system-level compounding):** leave behind reusable artifacts (machine-readable specs, checklists, test ideas) and surface failure modes clearly.\n\nThink of the system as an **Operations Research** problem: make the objective and constraints explicit; choose actions that maximize expected value under time/compute limits.\n\n## Context efficiency rule (important)\n\nKeep your work **sequential within your own slice**. Do not bounce between unrelated subproblems.\nIf you discover a new subtask, only start it if it is strictly necessary for your slice; otherwise record it as a \u201cnext action\u201d.\n\n## Hard output requirements\n\n- **No secrets.** Do not paste logs. Do not paste large raw data.\n- **Evidence:** if you used web research, include a short \u201cSources\u201d list (title + URL) and cite primary sources when possible.\n- **Artifacts > narration:** write durable artifacts to the requested paths (YAML/JSON/MD), then reference them.\n- **If the task says \u201cdo not approximate\u201d**: do not use inferred/estimated timings. Only report exact release timestamps and real-time vintage semantics that you can substantiate.\n\n## Required final lines (grep-friendly prompt feedback)\n\nAt the very end of your final response, include 1\u20133 lines, each starting with exactly one of:\n\n- `PROMPT_AMBIGUITY: ...`\n- `MISSING_INPUT: ...`\n- `PROMPT_DELTA: ...`\n\nNo secrets; no pasted logs; reference artifact paths if needed.\n\n## Default response structure\n\n1) **Deliverables**: bullet list of artifact paths created/updated.\n2) **Key Findings**: the core answers (what\u2019s true, what\u2019s unknown, what\u2019s blocked).\n3) **Verification**: how you verified (and what cannot be verified).\n4) **Next Actions**: concrete follow-ups for integration.\n5) **Prompt feedback**: the required `PROMPT_*` lines.\nAGENT_INJECTION_END\n\nCOMMON_PROMPT_START\n# Common Prompt \u2014 L3 MBO Engine Review (Rust, read\u2011only)\n\nYou are one of 6 parallel reviewers. Goal: evaluate **L3 MBO (market\u2011by\u2011order)** simulation correctness and realism in the Rust backtest engine. Prioritize **faithful queue\u2011position / fill logic** and **alignment to exchange reality** (esp. CME Globex) within the **existing design**. Do not broaden scope.\n\nHard constraints:\n- **Read\u2011only**: do not edit files; do not run cargo/tests; no file writes in repo.\n- **No web search**. Use only repo files and the CME order\u2011types spec at:\n  `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- **Focus on Rust** code in `hftbacktest/` only. Ignore examples/, docs/, py\u2011hftbacktest/, connector/, collector/, live/.\n- Provide **file:line** evidence for each issue.\n\nOutput format (strict):\n- **Run Report JSON** only, `schema_version=1.0.0`, with fields:\n  - `summary`\n  - `issues` (array; each has `id`, `severity`, `classification` = confirmed_bug|design_choice|needs_spec, `evidence`, `impact`, `reality_check`, `patch_sketch`, `test_idea`)\n  - `risk_gaps` (unknowns / spec gaps)\n  - `best_practice_recs` (realism upgrades that are optional)\n- End with 1\u20133 lines: `PROMPT_AMBIGUITY: ...` / `MISSING_INPUT: ...` / `PROMPT_DELTA: ...`\nCOMMON_PROMPT_END\n\nAgent 1/6 \u2014 L3 FIFO Queue Model correctness + realism\n\nScope (strict):\n- `hftbacktest/src/backtest/models/queue.rs` \u2014 focus on `L3QueueModel` trait + `L3FIFOQueueModel` implementation.\n- Follow any direct helpers in same file.\n\nTasks:\n1) Verify queue-position and FIFO ordering logic for L3 MBO: add/modify/cancel/fill/clear, best-bid/best-ask updates, and order-source tagging (market feed vs backtest).\n2) Check for realism mismatches vs exchange priority rules (price-time, partial fills, delete+fill ordering). Flag any CME-specific mismatches as `needs_spec` with exact references to spec gaps.\n3) Identify edge cases: duplicate order IDs, out-of-order events, queue corruption on clears, or cross update sequences.\n4) Provide a ranked issue list with impact on fill realism (optimistic/pessimistic bias).\n\nConstraints: read-only, no cargo, no edits, no web.\n\nOutput: Run Report JSON only + required PROMPT_* lines."
        }
      ]
    },
    {
      "job_id": "l3_review_02_exchange_processor",
      "working_directory": "hftbacktest",
      "steps": [
        {
          "step_id": "run",
          "timeout_seconds": 9000,
          "prompt": "AGENT_INJECTION_START\nYou are one of multiple parallel agents launched by an orchestrator (another GPT\u20115.2 instance).\nYou have a **narrow scope**. Do not expand it; do not \u201cimprove unrelated things\u201d.\n\n## Dual mandate (you must optimize both)\n\n1) **Mandate 2 (user goal):** execute your assigned slice to completion with high correctness.\n2) **Mandate 1 (system-level compounding):** leave behind reusable artifacts (machine-readable specs, checklists, test ideas) and surface failure modes clearly.\n\nThink of the system as an **Operations Research** problem: make the objective and constraints explicit; choose actions that maximize expected value under time/compute limits.\n\n## Context efficiency rule (important)\n\nKeep your work **sequential within your own slice**. Do not bounce between unrelated subproblems.\nIf you discover a new subtask, only start it if it is strictly necessary for your slice; otherwise record it as a \u201cnext action\u201d.\n\n## Hard output requirements\n\n- **No secrets.** Do not paste logs. Do not paste large raw data.\n- **Evidence:** if you used web research, include a short \u201cSources\u201d list (title + URL) and cite primary sources when possible.\n- **Artifacts > narration:** write durable artifacts to the requested paths (YAML/JSON/MD), then reference them.\n- **If the task says \u201cdo not approximate\u201d**: do not use inferred/estimated timings. Only report exact release timestamps and real-time vintage semantics that you can substantiate.\n\n## Required final lines (grep-friendly prompt feedback)\n\nAt the very end of your final response, include 1\u20133 lines, each starting with exactly one of:\n\n- `PROMPT_AMBIGUITY: ...`\n- `MISSING_INPUT: ...`\n- `PROMPT_DELTA: ...`\n\nNo secrets; no pasted logs; reference artifact paths if needed.\n\n## Default response structure\n\n1) **Deliverables**: bullet list of artifact paths created/updated.\n2) **Key Findings**: the core answers (what\u2019s true, what\u2019s unknown, what\u2019s blocked).\n3) **Verification**: how you verified (and what cannot be verified).\n4) **Next Actions**: concrete follow-ups for integration.\n5) **Prompt feedback**: the required `PROMPT_*` lines.\nAGENT_INJECTION_END\n\nCOMMON_PROMPT_START\n# Common Prompt \u2014 L3 MBO Engine Review (Rust, read\u2011only)\n\nYou are one of 6 parallel reviewers. Goal: evaluate **L3 MBO (market\u2011by\u2011order)** simulation correctness and realism in the Rust backtest engine. Prioritize **faithful queue\u2011position / fill logic** and **alignment to exchange reality** (esp. CME Globex) within the **existing design**. Do not broaden scope.\n\nHard constraints:\n- **Read\u2011only**: do not edit files; do not run cargo/tests; no file writes in repo.\n- **No web search**. Use only repo files and the CME order\u2011types spec at:\n  `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- **Focus on Rust** code in `hftbacktest/` only. Ignore examples/, docs/, py\u2011hftbacktest/, connector/, collector/, live/.\n- Provide **file:line** evidence for each issue.\n\nOutput format (strict):\n- **Run Report JSON** only, `schema_version=1.0.0`, with fields:\n  - `summary`\n  - `issues` (array; each has `id`, `severity`, `classification` = confirmed_bug|design_choice|needs_spec, `evidence`, `impact`, `reality_check`, `patch_sketch`, `test_idea`)\n  - `risk_gaps` (unknowns / spec gaps)\n  - `best_practice_recs` (realism upgrades that are optional)\n- End with 1\u20133 lines: `PROMPT_AMBIGUITY: ...` / `MISSING_INPUT: ...` / `PROMPT_DELTA: ...`\nCOMMON_PROMPT_END\n\nAgent 2/6 \u2014 L3 Exchange Processor logic (MBO ingestion \u2192 fills)\n\nScope (strict):\n- `hftbacktest/src/backtest/proc/l3_nopartialfillexchange.rs` (primary)\n- Any directly invoked helpers in `hftbacktest/src/backtest/proc/mod.rs`.\n\nTasks:\n1) Trace MBO event handling: add/modify/cancel/fill/clear ordering, queue-model updates, and fill generation.\n2) Identify mismatches vs L3 MBO feed reality: partial fills, delete vs fill ordering, trade quantity attribution, best bid/ask updates.\n3) Check for look-ahead or same-timestamp ordering bias when exchange and local orders interact.\n4) Provide severity-ranked issues + realism impact; minimal patch/test sketches.\n\nConstraints: read-only, no cargo, no edits, no web.\n\nOutput: Run Report JSON only + required PROMPT_* lines."
        }
      ]
    },
    {
      "job_id": "l3_review_03_local_processor_state",
      "working_directory": "hftbacktest",
      "steps": [
        {
          "step_id": "run",
          "timeout_seconds": 9000,
          "prompt": "AGENT_INJECTION_START\nYou are one of multiple parallel agents launched by an orchestrator (another GPT\u20115.2 instance).\nYou have a **narrow scope**. Do not expand it; do not \u201cimprove unrelated things\u201d.\n\n## Dual mandate (you must optimize both)\n\n1) **Mandate 2 (user goal):** execute your assigned slice to completion with high correctness.\n2) **Mandate 1 (system-level compounding):** leave behind reusable artifacts (machine-readable specs, checklists, test ideas) and surface failure modes clearly.\n\nThink of the system as an **Operations Research** problem: make the objective and constraints explicit; choose actions that maximize expected value under time/compute limits.\n\n## Context efficiency rule (important)\n\nKeep your work **sequential within your own slice**. Do not bounce between unrelated subproblems.\nIf you discover a new subtask, only start it if it is strictly necessary for your slice; otherwise record it as a \u201cnext action\u201d.\n\n## Hard output requirements\n\n- **No secrets.** Do not paste logs. Do not paste large raw data.\n- **Evidence:** if you used web research, include a short \u201cSources\u201d list (title + URL) and cite primary sources when possible.\n- **Artifacts > narration:** write durable artifacts to the requested paths (YAML/JSON/MD), then reference them.\n- **If the task says \u201cdo not approximate\u201d**: do not use inferred/estimated timings. Only report exact release timestamps and real-time vintage semantics that you can substantiate.\n\n## Required final lines (grep-friendly prompt feedback)\n\nAt the very end of your final response, include 1\u20133 lines, each starting with exactly one of:\n\n- `PROMPT_AMBIGUITY: ...`\n- `MISSING_INPUT: ...`\n- `PROMPT_DELTA: ...`\n\nNo secrets; no pasted logs; reference artifact paths if needed.\n\n## Default response structure\n\n1) **Deliverables**: bullet list of artifact paths created/updated.\n2) **Key Findings**: the core answers (what\u2019s true, what\u2019s unknown, what\u2019s blocked).\n3) **Verification**: how you verified (and what cannot be verified).\n4) **Next Actions**: concrete follow-ups for integration.\n5) **Prompt feedback**: the required `PROMPT_*` lines.\nAGENT_INJECTION_END\n\nCOMMON_PROMPT_START\n# Common Prompt \u2014 L3 MBO Engine Review (Rust, read\u2011only)\n\nYou are one of 6 parallel reviewers. Goal: evaluate **L3 MBO (market\u2011by\u2011order)** simulation correctness and realism in the Rust backtest engine. Prioritize **faithful queue\u2011position / fill logic** and **alignment to exchange reality** (esp. CME Globex) within the **existing design**. Do not broaden scope.\n\nHard constraints:\n- **Read\u2011only**: do not edit files; do not run cargo/tests; no file writes in repo.\n- **No web search**. Use only repo files and the CME order\u2011types spec at:\n  `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- **Focus on Rust** code in `hftbacktest/` only. Ignore examples/, docs/, py\u2011hftbacktest/, connector/, collector/, live/.\n- Provide **file:line** evidence for each issue.\n\nOutput format (strict):\n- **Run Report JSON** only, `schema_version=1.0.0`, with fields:\n  - `summary`\n  - `issues` (array; each has `id`, `severity`, `classification` = confirmed_bug|design_choice|needs_spec, `evidence`, `impact`, `reality_check`, `patch_sketch`, `test_idea`)\n  - `risk_gaps` (unknowns / spec gaps)\n  - `best_practice_recs` (realism upgrades that are optional)\n- End with 1\u20133 lines: `PROMPT_AMBIGUITY: ...` / `MISSING_INPUT: ...` / `PROMPT_DELTA: ...`\nCOMMON_PROMPT_END\n\nAgent 3/6 \u2014 L3 Local Processor + state invariants\n\nScope (strict):\n- `hftbacktest/src/backtest/proc/l3_local.rs`\n- `hftbacktest/src/backtest/state.rs` (state updates for fills/fees/position).\n\nTasks:\n1) Verify local order lifecycle correctness under L3 MBO: New/Modify/Cancel/Reject/Fill/Expire; ensure local state and exchange state remain consistent.\n2) Inspect queue-position initialization/updates for local orders, and any reset conditions on modify/cancel.\n3) Check ordering vs latency and exchange events (same timestamp interactions, queue-model updates).\n4) Provide ranked issues + realism implications + patch/test sketches.\n\nConstraints: read-only, no cargo, no edits, no web.\n\nOutput: Run Report JSON only + required PROMPT_* lines."
        }
      ]
    },
    {
      "job_id": "l3_review_04_market_depth_mbo",
      "working_directory": "hftbacktest",
      "steps": [
        {
          "step_id": "run",
          "timeout_seconds": 9000,
          "prompt": "AGENT_INJECTION_START\nYou are one of multiple parallel agents launched by an orchestrator (another GPT\u20115.2 instance).\nYou have a **narrow scope**. Do not expand it; do not \u201cimprove unrelated things\u201d.\n\n## Dual mandate (you must optimize both)\n\n1) **Mandate 2 (user goal):** execute your assigned slice to completion with high correctness.\n2) **Mandate 1 (system-level compounding):** leave behind reusable artifacts (machine-readable specs, checklists, test ideas) and surface failure modes clearly.\n\nThink of the system as an **Operations Research** problem: make the objective and constraints explicit; choose actions that maximize expected value under time/compute limits.\n\n## Context efficiency rule (important)\n\nKeep your work **sequential within your own slice**. Do not bounce between unrelated subproblems.\nIf you discover a new subtask, only start it if it is strictly necessary for your slice; otherwise record it as a \u201cnext action\u201d.\n\n## Hard output requirements\n\n- **No secrets.** Do not paste logs. Do not paste large raw data.\n- **Evidence:** if you used web research, include a short \u201cSources\u201d list (title + URL) and cite primary sources when possible.\n- **Artifacts > narration:** write durable artifacts to the requested paths (YAML/JSON/MD), then reference them.\n- **If the task says \u201cdo not approximate\u201d**: do not use inferred/estimated timings. Only report exact release timestamps and real-time vintage semantics that you can substantiate.\n\n## Required final lines (grep-friendly prompt feedback)\n\nAt the very end of your final response, include 1\u20133 lines, each starting with exactly one of:\n\n- `PROMPT_AMBIGUITY: ...`\n- `MISSING_INPUT: ...`\n- `PROMPT_DELTA: ...`\n\nNo secrets; no pasted logs; reference artifact paths if needed.\n\n## Default response structure\n\n1) **Deliverables**: bullet list of artifact paths created/updated.\n2) **Key Findings**: the core answers (what\u2019s true, what\u2019s unknown, what\u2019s blocked).\n3) **Verification**: how you verified (and what cannot be verified).\n4) **Next Actions**: concrete follow-ups for integration.\n5) **Prompt feedback**: the required `PROMPT_*` lines.\nAGENT_INJECTION_END\n\nCOMMON_PROMPT_START\n# Common Prompt \u2014 L3 MBO Engine Review (Rust, read\u2011only)\n\nYou are one of 6 parallel reviewers. Goal: evaluate **L3 MBO (market\u2011by\u2011order)** simulation correctness and realism in the Rust backtest engine. Prioritize **faithful queue\u2011position / fill logic** and **alignment to exchange reality** (esp. CME Globex) within the **existing design**. Do not broaden scope.\n\nHard constraints:\n- **Read\u2011only**: do not edit files; do not run cargo/tests; no file writes in repo.\n- **No web search**. Use only repo files and the CME order\u2011types spec at:\n  `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- **Focus on Rust** code in `hftbacktest/` only. Ignore examples/, docs/, py\u2011hftbacktest/, connector/, collector/, live/.\n- Provide **file:line** evidence for each issue.\n\nOutput format (strict):\n- **Run Report JSON** only, `schema_version=1.0.0`, with fields:\n  - `summary`\n  - `issues` (array; each has `id`, `severity`, `classification` = confirmed_bug|design_choice|needs_spec, `evidence`, `impact`, `reality_check`, `patch_sketch`, `test_idea`)\n  - `risk_gaps` (unknowns / spec gaps)\n  - `best_practice_recs` (realism upgrades that are optional)\n- End with 1\u20133 lines: `PROMPT_AMBIGUITY: ...` / `MISSING_INPUT: ...` / `PROMPT_DELTA: ...`\nCOMMON_PROMPT_END\n\nAgent 4/6 \u2014 L3 Market Depth (MBO) correctness + invariants\n\nScope (strict):\n- `hftbacktest/src/depth/mod.rs` (L3Order + L3MarketDepth trait)\n- `hftbacktest/src/depth/hashmapmarketdepth.rs`\n- `hftbacktest/src/depth/roivectormarketdepth.rs`\n- `hftbacktest/src/depth/btreemarketdepth.rs`\n\nTasks:\n1) Validate L3 order add/modify/cancel/fill semantics and their impact on best bid/ask + aggregated quantities.\n2) Check for MBO realism issues (e.g., partial fills, delete+fill ordering, implied quantity changes).\n3) Identify any invariant breaches or ordering assumptions that could corrupt queue position estimates.\n4) Provide ranked issues + minimal patch/test sketches.\n\nConstraints: read-only, no cargo, no edits, no web.\n\nOutput: Run Report JSON only + required PROMPT_* lines."
        }
      ]
    },
    {
      "job_id": "l3_review_05_event_pipeline_ordering",
      "working_directory": "hftbacktest",
      "steps": [
        {
          "step_id": "run",
          "timeout_seconds": 9000,
          "prompt": "AGENT_INJECTION_START\nYou are one of multiple parallel agents launched by an orchestrator (another GPT\u20115.2 instance).\nYou have a **narrow scope**. Do not expand it; do not \u201cimprove unrelated things\u201d.\n\n## Dual mandate (you must optimize both)\n\n1) **Mandate 2 (user goal):** execute your assigned slice to completion with high correctness.\n2) **Mandate 1 (system-level compounding):** leave behind reusable artifacts (machine-readable specs, checklists, test ideas) and surface failure modes clearly.\n\nThink of the system as an **Operations Research** problem: make the objective and constraints explicit; choose actions that maximize expected value under time/compute limits.\n\n## Context efficiency rule (important)\n\nKeep your work **sequential within your own slice**. Do not bounce between unrelated subproblems.\nIf you discover a new subtask, only start it if it is strictly necessary for your slice; otherwise record it as a \u201cnext action\u201d.\n\n## Hard output requirements\n\n- **No secrets.** Do not paste logs. Do not paste large raw data.\n- **Evidence:** if you used web research, include a short \u201cSources\u201d list (title + URL) and cite primary sources when possible.\n- **Artifacts > narration:** write durable artifacts to the requested paths (YAML/JSON/MD), then reference them.\n- **If the task says \u201cdo not approximate\u201d**: do not use inferred/estimated timings. Only report exact release timestamps and real-time vintage semantics that you can substantiate.\n\n## Required final lines (grep-friendly prompt feedback)\n\nAt the very end of your final response, include 1\u20133 lines, each starting with exactly one of:\n\n- `PROMPT_AMBIGUITY: ...`\n- `MISSING_INPUT: ...`\n- `PROMPT_DELTA: ...`\n\nNo secrets; no pasted logs; reference artifact paths if needed.\n\n## Default response structure\n\n1) **Deliverables**: bullet list of artifact paths created/updated.\n2) **Key Findings**: the core answers (what\u2019s true, what\u2019s unknown, what\u2019s blocked).\n3) **Verification**: how you verified (and what cannot be verified).\n4) **Next Actions**: concrete follow-ups for integration.\n5) **Prompt feedback**: the required `PROMPT_*` lines.\nAGENT_INJECTION_END\n\nCOMMON_PROMPT_START\n# Common Prompt \u2014 L3 MBO Engine Review (Rust, read\u2011only)\n\nYou are one of 6 parallel reviewers. Goal: evaluate **L3 MBO (market\u2011by\u2011order)** simulation correctness and realism in the Rust backtest engine. Prioritize **faithful queue\u2011position / fill logic** and **alignment to exchange reality** (esp. CME Globex) within the **existing design**. Do not broaden scope.\n\nHard constraints:\n- **Read\u2011only**: do not edit files; do not run cargo/tests; no file writes in repo.\n- **No web search**. Use only repo files and the CME order\u2011types spec at:\n  `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- **Focus on Rust** code in `hftbacktest/` only. Ignore examples/, docs/, py\u2011hftbacktest/, connector/, collector/, live/.\n- Provide **file:line** evidence for each issue.\n\nOutput format (strict):\n- **Run Report JSON** only, `schema_version=1.0.0`, with fields:\n  - `summary`\n  - `issues` (array; each has `id`, `severity`, `classification` = confirmed_bug|design_choice|needs_spec, `evidence`, `impact`, `reality_check`, `patch_sketch`, `test_idea`)\n  - `risk_gaps` (unknowns / spec gaps)\n  - `best_practice_recs` (realism upgrades that are optional)\n- End with 1\u20133 lines: `PROMPT_AMBIGUITY: ...` / `MISSING_INPUT: ...` / `PROMPT_DELTA: ...`\nCOMMON_PROMPT_END\n\nAgent 5/6 \u2014 L3 event pipeline + ordering (no lookahead)\n\nScope (strict):\n- `hftbacktest/src/backtest/mod.rs` (L3 builder + Backtest loop interactions relevant to L3)\n- `hftbacktest/src/backtest/data/*` (event ingestion order / timestamps for L3 feeds)\n- `hftbacktest/src/types.rs` (Event/OrdType/TimeInForce semantics).\n\nTasks:\n1) Verify ordering rules when L3 events share timestamps: add/modify/cancel/fill vs local orders vs best bid/ask updates.\n2) Identify any look-ahead or ordering bias that could inflate fills or queue advancement.\n3) Check whether event types & fields are sufficient to model CME order semantics in L3 path (flag as needs_spec if unclear).\n4) Provide ranked issues + minimal patch/test ideas.\n\nConstraints: read-only, no cargo, no edits, no web.\n\nOutput: Run Report JSON only + required PROMPT_* lines."
        }
      ]
    },
    {
      "job_id": "l3_review_06_cme_order_types_alignment",
      "working_directory": "hftbacktest",
      "steps": [
        {
          "step_id": "run",
          "timeout_seconds": 9000,
          "prompt": "AGENT_INJECTION_START\nYou are one of multiple parallel agents launched by an orchestrator (another GPT\u20115.2 instance).\nYou have a **narrow scope**. Do not expand it; do not \u201cimprove unrelated things\u201d.\n\n## Dual mandate (you must optimize both)\n\n1) **Mandate 2 (user goal):** execute your assigned slice to completion with high correctness.\n2) **Mandate 1 (system-level compounding):** leave behind reusable artifacts (machine-readable specs, checklists, test ideas) and surface failure modes clearly.\n\nThink of the system as an **Operations Research** problem: make the objective and constraints explicit; choose actions that maximize expected value under time/compute limits.\n\n## Context efficiency rule (important)\n\nKeep your work **sequential within your own slice**. Do not bounce between unrelated subproblems.\nIf you discover a new subtask, only start it if it is strictly necessary for your slice; otherwise record it as a \u201cnext action\u201d.\n\n## Hard output requirements\n\n- **No secrets.** Do not paste logs. Do not paste large raw data.\n- **Evidence:** if you used web research, include a short \u201cSources\u201d list (title + URL) and cite primary sources when possible.\n- **Artifacts > narration:** write durable artifacts to the requested paths (YAML/JSON/MD), then reference them.\n- **If the task says \u201cdo not approximate\u201d**: do not use inferred/estimated timings. Only report exact release timestamps and real-time vintage semantics that you can substantiate.\n\n## Required final lines (grep-friendly prompt feedback)\n\nAt the very end of your final response, include 1\u20133 lines, each starting with exactly one of:\n\n- `PROMPT_AMBIGUITY: ...`\n- `MISSING_INPUT: ...`\n- `PROMPT_DELTA: ...`\n\nNo secrets; no pasted logs; reference artifact paths if needed.\n\n## Default response structure\n\n1) **Deliverables**: bullet list of artifact paths created/updated.\n2) **Key Findings**: the core answers (what\u2019s true, what\u2019s unknown, what\u2019s blocked).\n3) **Verification**: how you verified (and what cannot be verified).\n4) **Next Actions**: concrete follow-ups for integration.\n5) **Prompt feedback**: the required `PROMPT_*` lines.\nAGENT_INJECTION_END\n\nCOMMON_PROMPT_START\n# Common Prompt \u2014 L3 MBO Engine Review (Rust, read\u2011only)\n\nYou are one of 6 parallel reviewers. Goal: evaluate **L3 MBO (market\u2011by\u2011order)** simulation correctness and realism in the Rust backtest engine. Prioritize **faithful queue\u2011position / fill logic** and **alignment to exchange reality** (esp. CME Globex) within the **existing design**. Do not broaden scope.\n\nHard constraints:\n- **Read\u2011only**: do not edit files; do not run cargo/tests; no file writes in repo.\n- **No web search**. Use only repo files and the CME order\u2011types spec at:\n  `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- **Focus on Rust** code in `hftbacktest/` only. Ignore examples/, docs/, py\u2011hftbacktest/, connector/, collector/, live/.\n- Provide **file:line** evidence for each issue.\n\nOutput format (strict):\n- **Run Report JSON** only, `schema_version=1.0.0`, with fields:\n  - `summary`\n  - `issues` (array; each has `id`, `severity`, `classification` = confirmed_bug|design_choice|needs_spec, `evidence`, `impact`, `reality_check`, `patch_sketch`, `test_idea`)\n  - `risk_gaps` (unknowns / spec gaps)\n  - `best_practice_recs` (realism upgrades that are optional)\n- End with 1\u20133 lines: `PROMPT_AMBIGUITY: ...` / `MISSING_INPUT: ...` / `PROMPT_DELTA: ...`\nCOMMON_PROMPT_END\n\nAgent 6/6 \u2014 CME order types/qualifiers alignment (Rust)\n\nScope (strict):\n- CME spec: `/Users/simongu/AAAHFT-Futures-Alpha-seek/research/specs/cme_order_types_feature_spec.md`\n- Rust order type handling: `hftbacktest/src/types.rs`, `hftbacktest/src/backtest/order.rs`, and L3 processors (`hftbacktest/src/backtest/proc/*`) as needed.\n\nTasks:\n1) Map CME DMA order types/qualifiers (OrdType, TimeInForce, MinQty, DisplayQty, StopPx, protection points) to Rust structures and logic actually implemented.\n2) Identify missing or mis-modeled semantics in the L3 path that impact fill realism. Classify as confirmed_bug vs needs_spec.\n3) Propose minimal implementation or modeling upgrades that preserve current design but improve realism (patch/test sketches).\n\nConstraints: read-only, no cargo, no edits, no web.\n\nOutput: Run Report JSON only + required PROMPT_* lines."
        }
      ]
    }
  ]
}